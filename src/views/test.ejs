<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>전통주 취향 테스트</title>
   <link rel="stylesheet" href="../public/test.css">
</head>
<body>

<!--     
  <form action="/test" method="get">
    <select name="q1" id="">
        <option value="ediya">이디야</option>
        <option value="start">스타벅스</option>
    </select>

    <select name="q2" id="">
      <option value="ediya">이디야</option>
      <option value="start">스타벅스</option>
  </select>


    <select name="q3" id="">
        <option value="1">주종1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
    </select>

      <select name="q4" id="">
        <option value="ediya">이디야</option>
        <option value="start">스타벅스</option>
    </select>

    <select name="q5" id="">
      <option value="ediya">이디야</option>
      <option value="start">스타벅스</option>
  </select>

  <select name="q6" id="">
    <option value="ediya">이디야</option>
    <option value="start">스타벅스</option>
  </select>

  <select name="q7" id="">
    <option value="ediya">이디야</option>
    <option value="start">스타벅스</option>
  </select>
    <input type="submit" value="질문제출"> -->

   
    <div id="title">
        <h1>전통주 취향 테스트</h1>
        <div>
        <img src="../uploads/home.PNG" alt="mainImg" class="imgs">
        </div>
        <p>나에게 맞는 전통주 취향을 알아보세요</p>

        <button onclick="js:start()">술 취향 테스트</button>
    </div>
 
  
    <div id="content">
        <div class="status">
            <div class="statusBar">
            </div>
        </div>
        <h1 id="q">

        </h1>

        <h3 id="a">
            
        </h3>
    </div>
 
   
    <div id="result">
        <h1>내 술 취향은?</h1>
        <div class="resultTitle">

        </div>
        <div id="resultImg">
        <!-- <img> -->
        </div>
        <div class="resultContent">

        </div>

        <button class="re" onclick="location.href='test2' ">전통주 추천 받기</button>
        <button class="re" onclick="location.href='test' ">다시하기</button>
        <button class="share">공유하기</button>
        
    </div>

    
  <!-- </form> -->
    
    <script charset="utf-8">
        const title = document.querySelector("#title");
        const content = document.querySelector("#content");
        const process = 8;
        const result = document.querySelector("#result");
        const select = [0, 0, 0, 0, 0, 0, 0, 0];
        const patterns = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
        const arr = [0,0];
        const arrs = [0,0];
        const arr3 = [0,0,0,0,0];
        const arr4 = [0,0];
        const arr5 = [0,0];
        const arr6 = [0,0];
        const arr7 = [0,0];
        const arr8 = [0,0];

        
      
        function cal(){
          console.log(patterns);

          let patterns_Sum = patterns.indexOf(1);
        while(patterns_Sum != -1)  {
          //document.writeln(patterns_Sum);
          patterns_Sum = patterns.indexOf(1, patterns_Sum+1);
        }
          
          console.log(patterns_Sum);
          return patterns_Sum

       
        }

        
        function cal1(){

          console.log(arr1);
            var result1 = arr1.indexOf(Math.max(...arr1));   //배열의 최댓값을 가지고 있는 인덱스 반환
            console.log(result1);
            return result1;

        }
        function cal2(){

          console.log(arr2);
            var result2 = arr2.indexOf(Math.max(...arr2));   //배열의 최댓값을 가지고 있는 인덱스 반환
            console.log(result2);
            return result2;

        }
        function cal3(){

          console.log(arr3);
            var result3 = arr3.indexOf(Math.max(...arr3));   //배열의 최댓값을 가지고 있는 인덱스 반환
            console.log(result3);
            return result3;

        }
        function cal4(){

          console.log(arr4);
            var result4 = arr4.indexOf(Math.max(...arr4));   //배열의 최댓값을 가지고 있는 인덱스 반환
            console.log(result4);
            return result4;

        }
        function cal5(){

          console.log(arr5);
            var result5 = arr5.indexOf(Math.max(...arr5));   //배열의 최댓값을 가지고 있는 인덱스 반환
            console.log(result5);
            return result5;

        }
        function cal6(){

          console.log(arr6);
            var result6 = arr6.indexOf(Math.max(...arr6));   //배열의 최댓값을 가지고 있는 인덱스 반환
            console.log(result6);
            return result6;

        }
        function cal7(){

          console.log(arr7);
            var result7 = arr7.indexOf(Math.max(...arr7));   //배열의 최댓값을 가지고 있는 인덱스 반환
            console.log(result7);
            return result7;

        }
        function cal8(){

          console.log(arr8);
            var result8 = arr8.indexOf(Math.max(...arr8));   //배열의 최댓값을 가지고 있는 인덱스 반환
            console.log(result8);
            return result8;

        }

        function get(){
          let points = cal();
          const rTitle = document.querySelector('.title');
          rTitle.innerHTML = infoList[points].name;   //인포리스트가 아니고 db에서 전통주명

          var rImg = document.createElement('.img');
          /* const imgDiv = document.querySelector('#resultImg');
          var imgURL = 'uploads/image-' + points + '.png';
          resultImg.src = imgURL;
          resultImg.alt = points;
          resultImg.classList.add('imgs');
          imgDiv.appendChild(resultImg); */

          const rContent = document.querySelector('.img');
          rContent.innerHTML = infoList[point].desc;    //인포리스트가 아니고 db에서 이미지
          
      }  

        function calculate(){
            console.log(select);
            var result = select.indexOf(Math.max(...select));   //배열의 최댓값을 가지고 있는 인덱스 반환
            console.log(result);
            return result;
          }
        function set(){
            let point = calculate();
            const resultTitle = document.querySelector('.resultTitle');
            resultTitle.innerHTML = infoList[point].name;

            var resultImg = document.createElement('img');
            const imgDiv = document.querySelector('#resultImg');
            var imgURL = 'uploads/image' + point + '.png';
            resultImg.src = imgURL;
            resultImg.alt = point;
            resultImg.classList.add('imgs');
            imgDiv.appendChild(resultImg);

            const resultContent = document.querySelector('.resultContent');
            resultContent.innerHTML = infoList[point].desc;
        }  
        

        function answer(answerText, num, id){
            let a = document.querySelector("#a");
            let answer = document.createElement("Button");
            
            answer.classList.add('answerList'); //질문버튼을 한 군집으로 묶어서 없애기 위해(다음 질문을 띄우기 위해) 하나로 묶는 클래스 생성
            answer.classList.add('fadeIn');
            
            let a1 = document.querySelectorAll("button");
            
            // arr.forEach(func(value, index, array))
             // value : 현재 순회 중인 요소
            //index : 현재 순회 중인 요소의 index
            //array : 배열 객체
          
            //for (let i = 0; i < answer.length; i++) {
            //  a1.setAttribute('name', i);
            //}  
            
           // a1.forEach((value,index) => {
           //   value.addEventListener('click', ()=> {
           //     value.setAttribute("data-id", `${value.innerHTML}`);
           //     itemFetch(value.innerHTML);
           //   })
           // })

           // async function itemFetch(id){
            //  let data = await fetch(`/test/${id}`);
           //   return window.location.href = `/test/${id}`;
           // }

            a.appendChild(answer);
            answer.innerHTML =answerText;
            answer.addEventListener("click", function(){
                let answers = document.querySelectorAll('.answerList')  //버튼을 하나로 묶은 클래스로 이루어진 변수
                for(let i = 0; i <answers.length; i++){
                    answers[i].disabled = true;     //답변 버튼중 하나만 클릭해도 다른 버튼들 무시
                    answers[i].style.WebkitAnimation = "fadeOut 0.5s";
                    answers[i].style.animation = "fadeOut 0.5s";
                    answers[i].style.display = 'none';    //and 버튼들 사라짐
                }
                setTimeout( ()=>{
                    var target = qList[num].a[id].type;   //몇번째 질문에서 몇번째 버튼을 클릭하였는지
                    for(let i = 0; i < target.length; i++){
                        select[target[i]] += 1;
                    }
                   // var targets = qList[num].a[id].pattern;   //몇번째 질문에서 몇번째 버튼을 클릭하였는지
                   // for(let i = 0; i < targets.length; i++){
                   //     patterns[targets[i]] += 1;
                   // }
                   
                    for(let i = 0; i <answers.length; i++){
                    answers[i].style.display = "none";
                    } next(++num);
                }, 450)
                
            })
        }

        function Result(){
            content.style.WebkitAnimation = "fadeOut 1s";
            content.style.animation = "fadeOut 1s";
            setTimeout( ()=>{
                result.style.WebkitAnimation = "fadeIn 1s";
                result.style.animation = "fadeIn 1s";
                setTimeout( ()=>{
                    content.style.display = "none";
                    result.style.display = "block";
                }, 450)})
                set();
                get();
            }

        function next(num){
            if(num ==  process){
                Result();
                return;
            }
            const q = document.querySelector("#q");
            q.innerHTML = qList[num].q;
            for (let i in qList[num].a){
                answer(qList[num].a[i].answer, num, i);
            } 
            let status = document.querySelector('.statusBar');
            status.style.width = (100/process) * (num + 1) + '%'
        }

        
        function start(){
           
           title.style.WebkitAnimation = "fadeOut 1s";
           title.style.animation = "fadeOut 1s";
           setTimeout( ()=>{
            content.style.WebkitAnimation = "fadeIn 1s";
            content.style.animation = "fadeIn 1s";
            setTimeout( ()=>{
                title.style.display = "none";
                content.style.display = "block";
            }, 450)
            let num = 0;
            next(num);
           }, 450);
           
        }
        
/*
mouse,0
cow,1
tiger,2
rabbit,3
dragon,4
snake,5
horse,6
sheep,7
monkey,8
chick,9
dog,10
pig,11
*/

const qList = [
  {
    q: '1. 내가 자주가는 카페는?',
    a: [
      { answer: 'a. 이디야', type: ['0', '1', '3'], pattern:['0'] },
      { answer: 'b. 스벅', type: ['2', '4', '5', '6', '7'], pattern:['1'] },
    ]
  },
  {
    q: '2. 술을 마시면 얼마나 먹어?  ',
    a: [
      { answer: 'a. 알딸딸~ 가볍게!', type: ['1', '5'], pattern:['1'] },
      { answer: 'b. 만취', type: ['0', '2'], pattern:['2'] },
    ]
  },
  {
    q: '3. 어떤 주종이 끌리나요?',
    a: [
      { answer: 'a. 탁주', type: ['1', '2', '4', '5'], pattern:['8'] },
      { answer: 'b. 약주', type: ['2'], pattern:['9'] },
      { answer: 'c. 증류주', type: ['0', '2'], pattern:['10'] },
      { answer: 'd. 과실주', type: ['7', '2', '4', '5'], pattern:['11'] },
      { answer: 'e. 기타주류', type: ['2'], pattern:['12'] },
    ]
  },
  {
    q: '4. 설빙에 갔다 어떤 메뉴를 고를까?',
    a: [
      { answer: 'a. 인절미 빙수 ', type: ['0'], pattern:['2'] },
      { answer: 'b. 초코 빙수 ', type: ['7', '5'], pattern:['3'] },
    ]
  },
  {
    q: '5. 냉면 먹을 때 식초를 얼마나 뿌릴까?',
    a: [
      { answer: 'a. 식초는 무슨~ 본연의 맛 그대로 먹자!', type: ['0'], pattern:['3'] },
      { answer: 'b. 식초는 2바퀴 이상 둘러야지!', type: ['5', '7', '6'], pattern:['4'] },
    ]
  },

  {
    q: '6. 식당에서 나올 때 후식으로 사탕이 있다. 당신이 고른 사탕은?',
    a: [
      { answer: 'a. 시원~한 박하사탕', type: ['7', '5' ], pattern:['4'] },
      { answer: 'b. 구수~한 누룽지사탕', type: ['0', '2', '6' ], pattern:['5'] },
    ]
  },
  {
    q: '7. 친구들끼리 놀러가는 차에서 노래를 선곡해야 한다면 어떤 스타일의 노래를 틀까?',
    a: [
      { answer: 'a. 신나는 여름노래, 댄스곡', type: ['5', '7' ], pattern:['5'] },
      { answer: 'b. 신나는건 랩이지!! 힙스터 느낌의 힙합', type: ['0','2', '4' ], pattern:['6'] },
    ]
  },
  {
    q: '8. 술자리에서 내가 더 가까운 포지션은?',
    a: [
      { answer: 'a. 안주는 내게 맡겨! "안주킬러" ', type: ['1', '5' ], pattern:['6'] },
      { answer: 'b. 안주는 무슨 술 먹기도 바빠! "알코올킬러"', type: ['0', '2', '4', '6' ], pattern:['7'] },
    ]
  },
 
]

const infoList = [
  {
    name: '먹고 죽자!, 술고래',
    desc: '저렴하지만 쉽게 취할 수 있는 화끈한 증류주를 추천합니다.'
  },
  {
    name: '술은 모르겠고 안주만 먹을래, 안주킬러',
    desc: '우리가 흔히 먹는 막걸리와 같은 탁주는 전이나 무침 등 우리 음식 안주와 잘 어울립니다. 안주를 좋아하면 탁주를 추천해요.'
  },
  {
    name: '술만 있으면 누구랑 언제 어디든 좋아!, 고독한 애주가',
    desc: '진정 술을 사랑하는 사람들! 이분은 어떠한 술이든 다 좋아하므로 본인의 취향에 맞는 술을 골라서 드세요. 대표적인 전통주의 맛을 느낄 수 있는 탁주를 먼저 드셔보아도 좋아요! '
  },
  {
    name: '술보단 술자리가 좋아, 자리지킴이',
    desc: '당신은 술을 잘 마실지도 못 마실지도 모르지만 술자리 평균 주량에 맞춰 드시길 바랍니다. 술자리를 따라다니다 보면 술자리가 잦기 때문에 저렴한 술을 드시는 것을 추천합니다. '
  },
  {
    name: '좋은 사람과 좋은 자리 그리고 좋은 술, 귀족',
    desc: '좋은 술을 찾는 유형! 특별한 날에 먹고 싶은 양주처럼 그에 못지않은 고급 전통주를 추천합니다. 고급 탁주나 과실주를 드시면 좋겠네요!'
  },
  {
    name: '한 잔만 먹어도 빨개져.., 홍당무',
    desc: '남들 주량에 따라가지 못하지만 그들과 술자리를 오래달리기 위해서는 도수가 낮은 과실주나 탁주류를 추천합니다.'
  },
  {
    name: '술을 음미하며 먹는 찐 술꾼, 전통소믈리에',
    desc: '술의 맛에 민감한 분들은 단맛, 신맛, 청량도를 맞춰 여러 술을 드셔보긴 권합니다. 바디감이 높은 술이 음미하기 좋겠죠?'
  },
  {
    name: '달달한 과일소주면 무한으로 먹지~, 칵테일 사랑',
    desc: '달달한 과일소주로 오래 즐기고 싶군요! 과일이 원재료인 과실주나 단맛이 강한 술을 추천합니다.'
  },
]
    </script>
</body>
</html>