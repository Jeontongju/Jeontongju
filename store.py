import csv
import requests
from bs4 import BeautifulSoup


pages=[13508292,
 291783538,
 1531531413,
 33085358,
 21834306,
 37309382,
 1203969721,
 33068345,
 31728975,
 18999395,
 18162074,
 33060879,
 33068375,
 31640475,
 1197478746,
 37148830,
 1927538056,
 1092732250,
 37708623,
 1522170498,
 1426098981,
 13419356,
 37315996,
 1040939211,
 20384015,
 37461075,
 1871553543,
 1661005694,
 1912086260,
 36508127,
 1715028873,
 37147979,
 37704375,
 1180584892,
 1971062401,
 13164694,
 1721690357,
 19882084,
 38233559,
 1710471391,
 13566449,
 21656874,
 13540350,
 18227756,
 20604959,
 20080944,
 1897802202,
 13154001,
 1779752042,
 38010707,
 1203185774,
 1964819613,
 1173649314,
 1685765272,
 1982822981,
 11677741,
 21908738,
 1534247950,
 12060573,
 1094851522,
 21913396,
 20455851,
 13489752,
 18592448,
 138491709,
 18601626,
 37421299,
 1155181712,
 1252808612,
 1025909131,
 11678251,
 1301812471,
 36987129,
 1457527969,
 35992572,
 1217986077,
 31542976,
 19728386,
 1018438355,
 1354960766,
 1236465611,
 1073051359,
 1331438803,
 19896339,
 1344042135,
 209814947,
 1891281658,
 19833225,
 11712589,
 13420134,
 32389954,
 37397782,
 32423786,
 1105131900,
 1044104104,
 1069333121,
 770869972,
 31650424,
 21668652,
 31676257,
 1156143801,
 37257366,
 1753210391,
 18097304,
 1723616331,
 138328317,
 13492273,
 31243351,
 1539351238,
 20870529,
 1378387298,
 19423604,
 31057494,
 38390086,
 1748678117,
 1276258820,
 19707868,
 20514860,
 21295716,
 12053230,
 1387606649,
 18225527,
 37488102,
 1281719454,
 1487106972,
 1009772184,
 19990379,
 21048837,
 1772771101,
 36424106,
 1020048868,
 31399770,
 36505130,
 21479747,
 1543365871,
 1214449534,
 1311415285,
 856093698,
 1367794483,
 33617982,
 38338084,
 37069468,
 1757467243,
 35701467,
 1941519131,
 206881489,
 20833080,
 16796711,
 1184288963,
 20844153,
 1175674727,
 31346839,
 1346012185,
 36980027,
 18149295,
 1647637720,
 21908741,
 1646489330,
 1382314808,
 1868487753,
 590658365,
 37320647,
 31134942,
 1160870772,
 1764011309,
 21136761,
 1495799171,
 19889354,
 13101696,
 20502764,
 13101696,
 20502764,
 1020487146,
 19851623,
 13577631,
 1425107833,
 21801055,
 20907435,
 1159615817,
 1502916479,
 37131480,
 1933644715,
 36003809,
 33674775,
 1600259876,
 1124077846,
 1903570903,
 31618311,
 33674784,
 1736325791,
 1593915617,
 37137835,
 19856449,
 21235648,
 13434196,
 299672608,
 1461625781,
 38003428,
 21399191,
 37134433,
 1122281983,
 34240476,
 11626180,
 1826470806,
 18570802,
 1349465396,
 37485998,
 18817897,
 21627245,
 1368525609,
 38368281,
 1532582199,
 32745780,
 16427311,
 32848729,
 1385904681,
 38275441,
 18727595,
 1303505026,
 21490326,
 37145081,
 37269391,
 21119193,
 1749739167,
 1503686647,
 20613561,
 20474030,
 452248678,
 21908417,
 1827642796,
 12964785,
 1504013134,
 1546308313,
 32848495,
 78773752,
 16846795,
 21487930,
 37944104,
 342792946,
 11857668,
 32102376,
 1216818389,
 33705336,
 38300550,
 32213512,
 1863339544,
 1392914912,
 1769217786,
 1277186713,
 1519922687,
 1061090612,
 1541747597,
 1133516468,
 18086243,
 37019384,
 30982455,
 687214047,
 11738095,
 1138910196,
 1943114098,
 102599437,
 13428722,
 1853513168,
 17872861,
 1635823354,
 18748328,
 37319140,
 36799427,
 37719455,
 31467064,
 1289531549,
 51871056,
 1183462316,
 1194106234,
 38709366,
 1721570290,
 11847262,
 17934943,
 1584491476,
 1931398460,
 20834414,
 33657476,
 1565003208,
 21025083,
 37392385,
 1015856974,
 1844847381,
 1517813883,
 20826919,
 1047280746,
 13338148,
 18630942,
 38373531,
 1568363838,
 20808296,
 21491270,
 1780563967,
 34822759,
 33212657]

def store():
    error_page=[]
    save_home_all=[]
    for i in range(len(pages)):
        save_home=[]
        #pgo=page_5[i]
        pgo=pages[i]
        
        # home에서 주점명, 전화번호, 주소 가져오기
        homeUrl='https://pcmap.place.naver.com/restaurant/'+str(pgo)+'/home'
        
        req = requests.get(homeUrl)
        html = req.content.decode('utf-8','replace') 
        soup = BeautifulSoup(html, 'html.parser')
        try:
            title=soup.select_one('.Fc1rA').text
            save_home.append(title)
            print(title)
        except:
            print(title) 
            print("처리 안 된 페이지",homeUrl)
            error_page.append(homeUrl)
            continue # 아예 저장 안 되게
        try:
            number=soup.select_one('.dry01').text
            save_home.append(number)
        except:
            save_home.append('')
        try:
            address=soup.select_one('.IH7VW').text
            save_home.append(address)
        except:
            save_home.append('')
        
        #save_home_all.append(save_home)
        
        # 메뉴 뽑기
        
        menuUrl='https://pcmap.place.naver.com/restaurant/'+str(pgo)+'/menu/list'
        req = requests.get(menuUrl)
        html = req.content.decode('utf-8','replace') 
        soup = BeautifulSoup(html, 'html.parser')
        
        menu=[]
        try:
            for menus in range(len(soup.select('.Sqg65'))):
                #print(soup.select('.Sqg65')[i].text)
                menu.append(soup.select('.Sqg65')[menus].text)
            if len(menu)==15:
                print("메뉴 15개 이상",menuUrl) # 더보기를 눌러야 하는 전통주점 체크하기
        except:
            continue
        
        save_home.append(menu)
        
        save_home_all.append(save_home) # 전체 저장

store()